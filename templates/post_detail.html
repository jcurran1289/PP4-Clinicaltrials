{% extends "base.html" %}

{% block content %}
{% load crispy_forms_tags %}

<body>

  <!-- Page content-->
  <div class="container mt-5">
    <div class="row">
      <div class="col">
        <!-- Post content-->
        <article>
          <!-- Post header-->
          <header class="mb-4">
            <!-- Post title-->
            <h1 class="fw-bolder mb-1 ">{{post.title}}</h1>
            <!-- Post meta content-->
            <div class="text-muted fst-italic mb-2">{{post.excerpt}}</div>
            <!-- Post categories-->
            <a class="badge bg-secondary text-decoration-none link-light" href="#!">Web Design</a>
            <a class="badge bg-secondary text-decoration-none link-light" href="#!">Freebies</a>
          </header>
          <!-- Preview image figure-->
          <!-- <figure class="mb-4"><img class="img-fluid rounded" src="https://dummyimage.com/900x400/ced4da/6c757d.jpg"
              alt="..." /></figure> -->
          {% if "placeholder" in post.featured_image.url %}
          <img class="card-img-top" src="https://codeinstitute.s3.amazonaws.com/fullstack/blog/default.jpg">
          {% else %}
          <!-- <img class="card-img-top" src=" {{ post.featured_image.url }}"> -->
          <h1>itshhherr</h1>
          {% endif %}
          <!-- Post content-->
          <section class="mb-5">
            <div class="row">
              <div class="col-lg-6 col-md-6">
                <p><b>Principal Investigator:</b> {{post.prin_invest}}</p>
              </div>
              <div class="col-lg-6 col-md-6">
                <p>IRB Number: {{post.irb_number}}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-6">
                <p>Contact Name: {{post.contact_name}}</p>
              </div>
              <div class="col-lg-6 col-md-6">
                <p>Email: {{post.contact_email}}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-6">
                <p>Age: {{post.eligible_age_min}} - {{post.eligible_age_max}}</p>
              </div>
              <div class="col-lg-6 col-md-6">
                <p>Gender: {{post.get_gender_display}}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-6 mx-auto">
                <p>Start Date: {{post.start_dt}}</p>
              </div>
              <div class="col-lg-6 col-md-6 mx-auto">
                <p>End Date: {{post.end_dt}}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-6 mx-auto">
                <p>Diseases:{{ post.primary_disease }}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-12 col-md-12 mx-auto">
                <p>{{post.content | safe }}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-6">
                <strong>
                  {% if user.is_authenticated %}
                  <form class="d-inline" action="{% url 'post_enroll' post.slug %}" method="POST">
                    {% csrf_token %}
                    {% if enrolled %}
                    <button type="submit" name="blogpost_id" value="{{post.slug}}" class="btn-like"
                      style="color: red">Leave</button>
                    {% else %}
                    <button type="submit" name="blogpost_id" value="{{post.slug}}" class="btn-like"
                      style="color: blue">Enroll</button>
                    {% endif %}
                  </form>
                  {% else %}
                  <span class="text-secondary"></span>
                  {% endif %}
                  <!-- The number of likes goes before the closing strong tag -->
                  <span class="text-secondary">Number of participants currently enrolled: {{ post.no_enrolled }} </span>
                </strong>
              </div>
            </div>

            <section class="mb-5">
              <div class="card bg-light">
                <div class="card-body">
                  <h3>Questions:</h3>
                  <!-- Comment form-->
                  <!-- <form class="mb-4"><textarea class="form-control" rows="3" placeholder="Ask a question">

                      </textarea></form> -->
                  {% if asked %}
                  <div class="alert alert-success" role="alert">
                    Your question is awaiting approval
                  </div>
                  {% else %}
                  {% if user.is_authenticated %}

                  <h3>Ask a question:</h3>
                  <p>Posting as: {{ user.username }}</p>
                  <form method="post" class="mb-4">
                    {{ question_form | crispy }}
                    {% csrf_token %}
                    <button type="submit" class="btn-like">Submit</button>
                  </form>
                  {% endif %}
                  {% endif %}
                  <!-- Comment with nested comments-->
                  <div class="d-flex mb-4">
                    <!-- Parent comment-->

                  </div>
                  <!-- Single comment-->
                  <div class="d-flex">
                    <div class="ms-3">
                      {% for question in questions %}
                      <div class="fw-bold">Commenter Name</div>
                      <div class="comments" style="padding: 10px;">
                        <p class="font-weight-bold">
                          <!-- The commenter's name goes here. Check the model if you're not sure what that is -->
                          {{ question.name }}
                          <span class=" text-muted font-weight-normal">
                            <!-- The comment's created date goes here -->
                            {{ question.created_on }}
                          </span> wrote:
                        </p>
                        <!-- The body of the comment goes before the | -->
                        {{ question.body | linebreaks }}
                      </div>
                      <!-- Our for loop ends here -->
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
            </section>

          </section>
        </article>
      </div>
    </div>
  </div>

</body>

{% endblock content %}